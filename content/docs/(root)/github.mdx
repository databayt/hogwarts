---
title: "GitHub Workflow"
description: "Complete guide to GitHub collaboration, pull requests, branch protection, and CI/CD automation for Hogwarts"
---

## Overview

Hogwarts follows industry-standard GitHub practices inspired by projects like [Next.js](https://github.com/vercel/next.js), [Cal.com](https://github.com/calcom/cal.com), and [shadcn/ui](https://github.com/shadcn-ui/ui). This guide covers everything you need to contribute effectively.

<div className="text-muted-foreground bg-muted flex items-center rounded-lg px-4 pt-4 text-sm">
  <strong>Key principle:</strong> All changes go through Pull Requests → Code
  Review → CI Checks → Merge
</div>

## Branch Protection

The `main` branch is protected. This means:

<div className="my-8 grid grid-cols-1 gap-6 md:grid-cols-2">
  <div className="border-destructive/50 rounded-lg border p-6">
    <h4 className="text-destructive mb-2 font-semibold">Not Allowed</h4>
    <div className="text-muted-foreground space-y-1 text-sm">
      <div>• Direct pushes to main</div>
      <div>• Force pushes</div>
      <div>• Deleting the branch</div>
      <div>• Merging without approval</div>
    </div>
  </div>
  <div className="rounded-lg border border-green-500/50 p-6">
    <h4 className="mb-2 font-semibold text-green-600">Required</h4>
    <div className="text-muted-foreground space-y-1 text-sm">
      <div>• Pull Request for all changes</div>
      <div>• 1 approval from CODEOWNER</div>
      <div>• All CI checks passing</div>
      <div>• Conversation resolution</div>
    </div>
  </div>
</div>

### Why Branch Protection?

Branch protection ensures:

- **Code Quality**: Every change is reviewed before merging
- **Stability**: CI checks catch bugs before they reach production
- **Accountability**: Clear history of who approved what
- **Security**: No unauthorized changes to the codebase

## Pull Request Workflow

### Step 1: Fork & Clone

```bash
# Fork via GitHub UI, then clone your fork
git clone git@github.com:YOUR_USERNAME/hogwarts.git
cd hogwarts

# Add upstream remote
git remote add upstream git@github.com:abdout/hogwarts.git
```

### Step 2: Create Feature Branch

```bash
# Always start from latest main
git checkout main
git pull upstream main

# Create your feature branch
git checkout -b feature/your-feature-name
```

**Branch Naming Convention:**

- `feature/` - New features (e.g., `feature/student-attendance-export`)
- `fix/` - Bug fixes (e.g., `fix/login-redirect-issue`)
- `docs/` - Documentation (e.g., `docs/api-reference`)
- `refactor/` - Code refactoring (e.g., `refactor/auth-module`)

### Step 3: Make Changes & Commit

```bash
# Make your changes, then stage
git add .

# Commit with conventional message
git commit -m "feat(platform): add attendance export to CSV"
```

**Commit Message Format:**

```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

Types: `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`, `ci`

### Step 4: Push & Create PR

```bash
# Push to your fork
git push origin feature/your-feature-name
```

Then open a Pull Request via GitHub. Our PR template will guide you through:

- Description of changes
- Type of change
- Screenshots/videos (for UI changes)
- Checklist of requirements

### Step 5: CI Checks Run Automatically

<div className="my-8 grid grid-cols-2 gap-4 md:grid-cols-4">
  <div className="rounded-lg border p-4 text-center">
    <div className="mb-2 text-2xl">TypeScript</div>
    <div className="text-muted-foreground text-sm">Type checking</div>
  </div>
  <div className="rounded-lg border p-4 text-center">
    <div className="mb-2 text-2xl">ESLint</div>
    <div className="text-muted-foreground text-sm">Code linting</div>
  </div>
  <div className="rounded-lg border p-4 text-center">
    <div className="mb-2 text-2xl">Vitest</div>
    <div className="text-muted-foreground text-sm">Unit tests</div>
  </div>
  <div className="rounded-lg border p-4 text-center">
    <div className="mb-2 text-2xl">Build</div>
    <div className="text-muted-foreground text-sm">Production build</div>
  </div>
</div>

**All checks must pass before merging.**

### Step 6: Code Review

A maintainer will review your PR. They may:

- **Approve**: Ready to merge
- **Request Changes**: Needs modifications
- **Comment**: Questions or suggestions

Address feedback by pushing new commits to your branch.

### Step 7: Merge

Once approved and all checks pass, a maintainer will merge your PR. Your contribution is now live!

## Issue Templates

When reporting issues or requesting features, use our templates:

### Bug Reports

Include:

- Clear description of the bug
- Steps to reproduce
- Expected vs actual behavior
- Screenshots/videos
- Browser and OS information
- Affected area (Platform, Auth, Finance, etc.)

### Feature Requests

Include:

- Problem statement
- Proposed solution
- Alternatives considered
- Priority level
- Willingness to contribute

### Documentation Issues

Include:

- Location of incorrect/missing docs
- What's wrong or missing
- Suggested improvement

## CI/CD Pipeline

### PR Checks (`pr-check.yml`)

Every PR triggers:

| Job         | Description            | Must Pass |
| ----------- | ---------------------- | --------- |
| `typecheck` | TypeScript compilation | Yes       |
| `lint`      | ESLint validation      | Yes       |
| `test`      | Vitest unit tests      | Yes       |
| `build`     | Production build       | Yes       |

### Security Scanning (`codeql.yml`)

- **CodeQL Analysis**: Scans for security vulnerabilities
- Runs on: Every PR and weekly schedule
- Languages: JavaScript/TypeScript

### Dependency Updates (`dependabot.yml`)

- **Weekly updates**: Every Monday
- **Grouped PRs**: Development, testing, React, Next.js dependencies
- **Auto-labeled**: `dependencies`, `automated`

### Auto-Labeling

PRs are automatically labeled based on files changed:

| Label            | Files                           |
| ---------------- | ------------------------------- |
| `area: platform` | `src/components/platform/**`    |
| `area: auth`     | `src/auth*`, `auth.ts`          |
| `area: database` | `prisma/**`                     |
| `area: docs`     | `docs/**`, `content/**`, `*.md` |
| `area: ui`       | `src/components/ui/**`          |
| `type: ci`       | `.github/**`                    |
| `type: tests`    | `*.test.*`, `tests/**`          |

### Stale Issue Management

- Issues/PRs marked stale after 30 days of inactivity
- Closed after 7 more days
- Exempt: `pinned`, `security`, `help wanted`, `good first issue`

## CODEOWNERS

The [CODEOWNERS](https://github.com/abdout/hogwarts/blob/main/.github/CODEOWNERS) file defines who must review changes to specific areas:

```
# Default owner
* @abdout

# Specific areas
/src/components/platform/ @abdout
/prisma/ @abdout
/src/auth* @abdout
/.github/ @abdout
```

When you modify files in these areas, the corresponding owner is automatically requested for review.

## Security

### Reporting Vulnerabilities

**DO NOT** open public issues for security vulnerabilities.

Instead:

1. Email `security@databayt.org`
2. Include: type, affected files, reproduction steps, impact
3. We'll respond within 48 hours

See [SECURITY.md](https://github.com/abdout/hogwarts/blob/main/SECURITY.md) for full policy.

### Security Best Practices

When contributing:

- Always include `schoolId` in database queries (multi-tenant safety)
- Use Zod schemas for input validation
- Never commit secrets or credentials
- Keep dependencies updated

## Essential Git Commands

### Staying Synced

```bash
# Update your fork with upstream changes
git checkout main
git fetch upstream
git merge upstream/main
git push origin main

# Rebase your feature branch
git checkout feature/your-feature
git rebase main
```

### Fixing Mistakes

```bash
# Undo last commit (keep changes)
git reset --soft HEAD~1

# Undo last commit (discard changes)
git reset --hard HEAD~1

# Amend last commit message
git commit --amend -m "new message"

# Undo changes to a file
git checkout -- filename
```

### Cleaning Up

```bash
# Delete local branch
git branch -d feature/your-feature

# Delete remote branch
git push origin --delete feature/your-feature

# Prune deleted remote branches
git remote prune origin
```

## Quick Reference

<div className="my-8 grid grid-cols-1 gap-6 md:grid-cols-2">
  <div className="rounded-lg border p-6">
    <h4 className="mb-2 font-semibold">For Contributors</h4>
    <div className="text-muted-foreground space-y-1 text-sm">
      <div>1. Fork the repository</div>
      <div>2. Create a feature branch</div>
      <div>3. Make changes with conventional commits</div>
      <div>4. Push and open a PR</div>
      <div>5. Wait for review and CI checks</div>
      <div>6. Address feedback</div>
      <div>7. Get merged!</div>
    </div>
  </div>
  <div className="rounded-lg border p-6">
    <h4 className="mb-2 font-semibold">Before Submitting PR</h4>
    <div className="text-muted-foreground space-y-1 text-sm">
      <div>• Run `pnpm tsc --noEmit`</div>
      <div>• Run `pnpm lint`</div>
      <div>• Run `pnpm test`</div>
      <div>• Test your changes locally</div>
      <div>• Update documentation if needed</div>
      <div>• Fill out PR template completely</div>
    </div>
  </div>
</div>

## Resources

- [Contributing Guide](/docs/contributing) - Detailed contribution guide
- [First PR Guide](/docs/first-pr) - Your first pull request
- [Code of Conduct](/docs/code-of-conduct) - Community standards
- [GitHub Docs](https://docs.github.com) - Official GitHub documentation
- [Conventional Commits](https://www.conventionalcommits.org/) - Commit message standard
- [GitHub Flow](https://docs.github.com/en/get-started/using-github/github-flow) - Branch-based workflow

---

**Questions?** Join our [Discord](https://discord.gg/uPa4gGG62c) or open a [Discussion](https://github.com/abdout/hogwarts/discussions).
