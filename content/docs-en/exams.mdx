---
title: "Exams"
description: "Complete guide to the examination management module - question bank, exam generation, auto-marking with AI, results analytics, and PDF reports"
---

## Overview

The Exams module provides a comprehensive, production-ready examination management system. It supports question banks, template-based exam generation, AI-assisted grading, and detailed analytics with PDF report generation.

### Key Features

| Feature           | Status         | Description                                             |
| ----------------- | -------------- | ------------------------------------------------------- |
| Question Bank     | **Production** | Store and manage questions by subject, type, difficulty |
| Exam Templates    | **Production** | Reusable blueprints for exam generation                 |
| Auto-Generation   | **Production** | Generate exams from templates with smart selection      |
| AI Question Gen   | **Beta**       | Generate questions from curriculum using AI             |
| Auto-Marking      | **Production** | Automatic grading for MCQ, T/F, Fill Blank              |
| AI Grading        | **Production** | AI-assisted grading for essays and short answers        |
| OCR Processing    | **Production** | Extract text from handwritten answers                   |
| Results Analytics | **Production** | Comprehensive performance analysis                      |
| PDF Reports       | **Production** | Generate individual and batch result PDFs               |
| CSV Import/Export | **Production** | Bulk operations for questions and results               |

## Quick Start

Navigate to **Exams** in the platform sidebar to access the module.

### Dashboard Overview

The exam dashboard displays:

- **Stats Cards** - Total exams, upcoming, question bank size, students enrolled
- **Progress Indicators** - Completion rate, pending marking, results generated
- **Feature Blocks** - Quick access to Question Bank, Generate, Mark, Results
- **Workflow Guide** - Step-by-step exam lifecycle visualization

## Exam Lifecycle Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    EXAM LIFECYCLE FLOW                          │
└─────────────────────────────────────────────────────────────────┘

   [1] QUESTION BANK          [2] GENERATE                [3] EXAMS
   (/exams/qbank)            (/exams/generate)           (/exams/new)
   ┌─────────────┐           ┌─────────────┐           ┌─────────────┐
   │ • Add Q's   │           │ • Templates │           │ • Schedule  │
   │ • MCQ/T-F   │───────────│ • AI Gen    │───────────│ • Assign    │
   │ • Essay     │           │ • Distribute│           │ • Set Marks │
   │ • Import    │           │ • Preview   │           │ • Publish   │
   └─────────────┘           └─────────────┘           └─────────────┘
                                                              │
                                    ┌─────────────────────────┘
                                    ▼
   [4] MARKING                                          [5] RESULTS
   (/exams/mark)                                       (/exams/result)
   ┌─────────────┐                                    ┌─────────────┐
   │ • Auto-Mark │                                    │ • Analytics │
   │ • AI-Grade  │────────────────────────────────────│ • PDF Gen   │
   │ • Manual    │                                    │ • Export    │
   │ • Bulk Ops  │                                    │ • Reports   │
   └─────────────┘                                    └─────────────┘
```

## Question Bank

### Overview

The Question Bank is a repository of reusable questions organized by subject, type, difficulty, and Bloom's taxonomy level.

### Question Types

| Type              | Description                            | Auto-Gradable |
| ----------------- | -------------------------------------- | ------------- |
| Multiple Choice   | Select one correct answer from options | Yes           |
| True/False        | Binary choice questions                | Yes           |
| Fill in the Blank | Student provides exact answer          | Yes           |
| Short Answer      | 1-2 sentence responses                 | AI-Assisted   |
| Essay             | Long-form written responses            | AI-Assisted   |

### Adding Questions

**01. Navigate to Question Bank**

Go to Exams → Question Bank → New Question

---

**02. Select Subject**

Choose the subject for this question

---

**03. Select Question Type**

Pick from MCQ, True/False, Fill Blank, Short Answer, or Essay

---

**04. Enter Question Text**

Write the question clearly and concisely

---

**05. Set Difficulty & Bloom Level**

- **Difficulty**: Easy, Medium, Hard
- **Bloom Level**: Remember, Understand, Apply, Analyze, Evaluate, Create

---

**06. Add Options/Answers**

Based on question type:

- **MCQ**: Add options with correct answer marked
- **True/False**: System auto-creates True/False options
- **Fill Blank**: Add accepted answers (case-sensitive option)
- **Short Answer**: Provide sample answer
- **Essay**: Add sample answer and grading rubric

---

**07. Add Tags**

Add topic tags for filtering (e.g., algebra, quadratic-equations)

---

**08. Save**

Click Create to add to the question bank

### Bulk Import

Import questions from CSV:

```csv
questionText,questionType,difficulty,bloomLevel,points,options,sampleAnswer,tags
"What is 2+2?",MULTIPLE_CHOICE,EASY,REMEMBER,1,"[{""text"":""4"",""isCorrect"":true},{""text"":""3"",""isCorrect"":false}]","","math,arithmetic"
"The Earth is flat.",TRUE_FALSE,EASY,REMEMBER,1,"[{""text"":""True"",""isCorrect"":false},{""text"":""False"",""isCorrect"":true}]","","science,geography"
```

### Question Analytics

Track question performance:

- **Times Used** - How often the question appears in exams
- **Success Rate** - Percentage of students answering correctly
- **Average Time** - Time students spend on this question
- **Perceived Difficulty** - Actual difficulty vs. labeled difficulty

## Exam Templates

### Overview

Templates define the structure and distribution of questions for exams. They can be reused to generate multiple exams with consistent structure.

### Creating Templates

**01. Navigate to Templates**

Go to Exams → Generate → Templates → New Template

---

**02. Basic Information**

- **Name**: Template name (e.g., "Math Mid-Term Template")
- **Subject**: Associated subject
- **Duration**: Total exam time in minutes
- **Total Marks**: Maximum score

---

**03. Question Distribution**

Define how many questions of each type and difficulty:

```json
{
  "MULTIPLE_CHOICE": { "EASY": 5, "MEDIUM": 5, "HARD": 3 },
  "TRUE_FALSE": { "EASY": 5 },
  "SHORT_ANSWER": { "MEDIUM": 3, "HARD": 2 },
  "ESSAY": { "HARD": 1 }
}
```

---

**04. Bloom's Distribution (Optional)**

Specify cognitive level requirements:

```json
{
  "REMEMBER": 5,
  "UNDERSTAND": 5,
  "APPLY": 5,
  "ANALYZE": 3,
  "EVALUATE": 2
}
```

---

**05. Save Template**

Template is now available for exam generation

### Available Templates (Seeded)

| Template                     | Subject          | Duration | Marks |
| ---------------------------- | ---------------- | -------- | ----- |
| Mathematics Mid-Term         | Mathematics      | 90 min   | 50    |
| Physics Final Exam           | Physics          | 120 min  | 100   |
| English Quick Quiz           | English          | 30 min   | 25    |
| Biology Lab Assessment       | Biology          | 60 min   | 40    |
| Computer Science Coding Test | Computer Science | 90 min   | 50    |
| History Comprehensive Test   | History          | 75 min   | 60    |
| Arabic Language Assessment   | Arabic           | 90 min   | 50    |

## Exam Generation

### From Template

**01. Select Template**

Choose from available templates

---

**02. Preview Generation**

System shows:

- Question pool availability
- Any missing categories
- Estimated coverage

---

**03. Generate**

Click Generate to create the exam with randomly selected questions

---

**04. Review & Customize**

- Reorder questions if needed
- Replace specific questions
- Adjust point values

---

**05. Create Exam**

Finalize and schedule the exam

### Smart Selection Algorithm

The generation algorithm:

1. Groups questions by type and difficulty
2. Fills distribution requirements from pool
3. Applies Bloom's level distribution if specified
4. Uses seeded randomization for reproducibility
5. Prevents duplicate questions in same exam

## Marking & Grading

### Overview

The marking system supports three grading methods:

- **Auto-Mark** - Instant grading for objective questions
- **AI-Assisted** - AI grades subjective questions with rubrics
- **Manual** - Teacher grades and provides feedback

### Auto-Marking

Automatically grades:

- **Multiple Choice** - Exact match with partial credit option
- **True/False** - Boolean validation
- **Fill in the Blank** - Matches against accepted answers (case-sensitive option)

**How it works:**

```
Student submits answer
        ↓
System fetches correct answer
        ↓
Compare and calculate score
        ↓
Create MarkingResult with:
  - pointsAwarded
  - isCorrect
  - confidence (100% for auto)
```

### AI-Assisted Grading

For essays and short answers:

**01. Fetch Student Answer**

Get submitted text (or OCR from image)

---

**02. Load Rubric**

Fetch grading criteria for the question

---

**03. AI Evaluation**

GPT-4o evaluates against rubric:

- Criterion-by-criterion scoring
- Detailed reasoning
- Suggested feedback
- Confidence score (0-1)

---

**04. Create Result**

```typescript
{
  pointsAwarded: 8.5,
  aiScore: 8.5,
  aiConfidence: 0.87,
  aiReasoning: "Strong thesis but weak supporting evidence...",
  needsReview: true, // if confidence < 0.85
  feedback: "Consider adding more examples..."
}
```

---

**05. Teacher Review**

If confidence is low, teacher reviews and confirms/adjusts

### OCR Processing

For handwritten answers:

**01. Student uploads image**

Photo of written response

---

**02. OCR extraction**

GPT-4 Vision extracts text

---

**03. Confidence score**

System rates extraction confidence

---

**04. Continue to grading**

Text proceeds to auto-mark or AI-grade

### Bulk Operations

**Bulk Auto-Grade**

Grade all objective questions for an exam at once

**Bulk AI-Grade**

Queue all essays/short answers for AI processing

**Import Marks from CSV**

```csv
studentId,questionId,pointsAwarded,feedback
student_123,question_456,8.5,"Good analysis"
```

### Marking Status Flow

```
NOT_STARTED
      ↓
      ├→ AUTO_GRADED (auto-marked, may need review)
      ├→ AI_GRADED (AI-marked, pending review)
      └→ IN_PROGRESS (partial manual grading)
      ↓
REVIEWED (teacher reviewed AI/auto grades)
      ↓
COMPLETED (finalized - can be overridden)
```

## Results & Analytics

### Results Dashboard

View and manage exam results:

- **Exam List** - All completed exams with stats
- **Class Average** - Mean score per exam
- **Pass Rate** - Percentage meeting passing marks
- **Grade Distribution** - A/B/C/D/F breakdown

### Individual Results

For each student:

- Total marks obtained
- Percentage score
- Letter grade
- Rank in class
- Question-by-question breakdown
- Teacher feedback

### Analytics Features

**Class-Level Analytics:**

- Average, median, mode scores
- Standard deviation
- Top/bottom performers
- Grade distribution chart
- Trend over time

**Question-Level Analytics:**

- Item discrimination index
- Distractor analysis (for MCQ)
- Most missed questions
- Average time per question

### PDF Reports

Generate printable result reports:

**Templates Available:**

1. **Classic** - Traditional report card style
2. **Modern** - Contemporary design with charts
3. **Minimal** - Clean, simple layout

**Report Contents:**

- Student information
- School branding
- Exam details
- Marks breakdown
- Grade with GPA
- Class rank
- Teacher comments
- Parent signature line

**Batch Generation:**

- Generate PDFs for entire class
- Progress tracking
- ZIP download
- Background processing for large batches

### Export Options

- **CSV** - Raw data for spreadsheets
- **Excel** - Formatted with multiple sheets
- **PDF** - Individual or batch reports

## Grade Boundaries

Configure school-specific grade boundaries:

| Grade | Min Score | Max Score | GPA  |
| ----- | --------- | --------- | ---- |
| A+    | 95%       | 100%      | 4.00 |
| A     | 90%       | 94.99%    | 3.70 |
| B+    | 85%       | 89.99%    | 3.30 |
| B     | 80%       | 84.99%    | 3.00 |
| C+    | 75%       | 79.99%    | 2.70 |
| C     | 70%       | 74.99%    | 2.30 |
| D+    | 65%       | 69.99%    | 2.00 |
| D     | 60%       | 64.99%    | 1.70 |
| F     | 0%        | 59.99%    | 0.00 |

## Routes Reference

| Route                           | Purpose                   |
| ------------------------------- | ------------------------- |
| `/exams`                        | Main dashboard with stats |
| `/exams/new`                    | Create new exam           |
| `/exams/[id]`                   | View exam details         |
| `/exams/[id]/edit`              | Edit exam                 |
| `/exams/upcoming`               | Upcoming exams list       |
| `/exams/qbank`                  | Question bank             |
| `/exams/qbank/new`              | Add new question          |
| `/exams/qbank/[id]`             | Question details          |
| `/exams/qbank/ai-generate`      | AI question generation    |
| `/exams/generate`               | Generation dashboard      |
| `/exams/generate/templates`     | Manage templates          |
| `/exams/generate/templates/new` | Create template           |
| `/exams/mark`                   | Marking dashboard         |
| `/exams/mark/pending`           | Pending exams             |
| `/exams/mark/grade/[id]`        | Grade specific exam       |
| `/exams/mark/bulk/[id]`         | Bulk grading              |
| `/exams/result`                 | Results list              |
| `/exams/result/[id]`            | Exam results detail       |
| `/exams/result/analytics`       | Analytics dashboard       |
| `/exams/result/[id]/pdf/batch`  | Batch PDF generation      |

## API Reference

### Server Actions

```typescript
// Question Bank
createQuestion(formData: FormData)
updateQuestion(formData: FormData)
deleteQuestion(id: string)
getQuestions(filters: QuestionFilters)
duplicateQuestion(id: string)

// Templates
createTemplate(data: TemplateInput)
updateTemplate(id: string, data: TemplateInput)
deleteTemplate(id: string)
getTemplates(subjectId?: string)

// Generation
generateExam(templateId: string, examId: string)
previewExamGeneration(templateId: string)
regenerateExam(generatedExamId: string)

// Marking
autoGradeAnswer(studentAnswerId: string)
aiGradeAnswer(studentAnswerId: string)
manualGrade(answerId: string, points: number, feedback?: string)
bulkGradeExam(examId: string, method: GradingMethod)
overrideGrade(resultId: string, newScore: number, reason: string)

// Results
getExamResults(examId: string, options?: ResultOptions)
getExamAnalytics(examId: string)
generateSinglePDF(studentId: string, examId: string, template: string)
generateBatchPDFs(examId: string, studentIds?: string[])
exportResultsToCSV(examId: string)
```

### Types

```typescript
type QuestionType =
  | "MULTIPLE_CHOICE"
  | "TRUE_FALSE"
  | "SHORT_ANSWER"
  | "ESSAY"
  | "FILL_BLANK"

type DifficultyLevel = "EASY" | "MEDIUM" | "HARD"

type BloomLevel =
  | "REMEMBER"
  | "UNDERSTAND"
  | "APPLY"
  | "ANALYZE"
  | "EVALUATE"
  | "CREATE"

type ExamStatus = "PLANNED" | "IN_PROGRESS" | "COMPLETED" | "CANCELLED"

type ExamType = "QUIZ" | "MIDTERM" | "FINAL" | "PRACTICE" | "DIAGNOSTIC"

type GradingMethod = "AUTO" | "AI_ASSISTED" | "MANUAL"

type MarkingStatus =
  | "NOT_STARTED"
  | "AUTO_GRADED"
  | "AI_GRADED"
  | "IN_PROGRESS"
  | "REVIEWED"
  | "COMPLETED"
```

## Database Schema

Key Prisma models:

```prisma
model QuestionBank {
  id           String          @id @default(cuid())
  schoolId     String
  subjectId    String
  questionText String
  questionType QuestionType
  difficulty   DifficultyLevel
  bloomLevel   BloomLevel
  points       Decimal
  options      Json?           // MCQ options, fill blank answers
  sampleAnswer String?
  gradingRubric String?
  tags         String[]
  explanation  String?
  source       QuestionSource

  @@index([schoolId, subjectId])
  @@index([schoolId, questionType, difficulty])
}

model ExamTemplate {
  id           String  @id @default(cuid())
  schoolId     String
  name         String
  subjectId    String
  duration     Int     // minutes
  totalMarks   Int
  distribution Json    // question type/difficulty counts
  bloomDistribution Json?
  isActive     Boolean @default(true)

  @@unique([schoolId, name])
}

model Exam {
  id           String     @id @default(cuid())
  schoolId     String
  title        String
  classId      String
  subjectId    String
  examDate     DateTime
  duration     Int
  totalMarks   Int
  passingMarks Int
  examType     ExamType
  status       ExamStatus

  @@index([schoolId, status])
  @@index([schoolId, examDate])
}

model ExamResult {
  id            String  @id @default(cuid())
  schoolId      String
  examId        String
  studentId     String
  marksObtained Int
  totalMarks    Int
  percentage    Float
  grade         String
  isAbsent      Boolean @default(false)

  @@unique([schoolId, examId, studentId])
}

model MarkingResult {
  id             String        @id @default(cuid())
  schoolId       String
  studentAnswerId String
  examId         String
  questionId     String
  studentId      String
  gradingMethod  GradingMethod
  status         MarkingStatus
  pointsAwarded  Decimal
  maxPoints      Decimal
  aiScore        Decimal?
  aiConfidence   Float?
  aiReasoning    String?
  feedback       String?
  needsReview    Boolean       @default(false)

  @@unique([schoolId, studentAnswerId])
}
```

## Seed Data

The exam seed creates comprehensive test data:

### Questions (70+ across 9 subjects)

| Subject          | Count | Types                        |
| ---------------- | ----- | ---------------------------- |
| Mathematics      | 8     | MCQ, T/F, Short, Essay, Fill |
| Physics          | 6     | MCQ, T/F, Short, Essay, Fill |
| English          | 5     | MCQ, T/F, Short, Essay, Fill |
| Biology          | 5     | MCQ, T/F, Short, Essay, Fill |
| Chemistry        | 8     | MCQ, T/F, Short, Essay, Fill |
| Computer Science | 8     | MCQ, T/F, Short, Essay, Fill |
| History          | 6     | MCQ, T/F, Short, Essay, Fill |
| Geography        | 6     | MCQ, T/F, Short, Essay, Fill |
| Arabic           | 5     | MCQ, T/F, Short, Essay, Fill |

### Templates (8 total)

Pre-configured templates for each major subject with appropriate distributions.

### Sample Exams

- 27 exams (3 per subject: Midterm, Final, Quiz)
- Various statuses: COMPLETED, PLANNED, IN_PROGRESS
- Complete with exam results for completed exams

### Additional Data

- Grade boundaries (A+ to F)
- Rubrics for essay questions
- Question analytics
- Student answers and marking results

Run seed:

```bash
pnpm db:seed
```

## Best Practices

### For Teachers

1. Build a robust question bank before creating exams
2. Use templates for consistent exam structure
3. Tag questions thoroughly for easy filtering
4. Review AI-graded essays, especially low-confidence ones
5. Provide constructive feedback on essays
6. Use analytics to identify weak areas

### For Administrators

1. Configure appropriate grade boundaries
2. Monitor school-wide exam statistics
3. Ensure adequate question bank coverage
4. Review AI grading accuracy periodically
5. Set up backup procedures for exam data

### For Question Writing

1. Write clear, unambiguous questions
2. For MCQ, make distractors plausible
3. Set appropriate difficulty levels
4. Include explanations for learning
5. Tag with relevant topics
6. Provide comprehensive rubrics for essays

## Troubleshooting

### Exam Generation Fails

- Check question bank has enough questions
- Verify distribution can be satisfied
- Review template configuration

### AI Grading Issues

- Ensure OpenAI API key is configured
- Check rate limits aren't exceeded
- Verify rubric exists for the question

### PDF Generation Problems

- Check @react-pdf/renderer is installed
- Verify school branding is configured
- For batch: ensure adequate server memory

### Marks Not Calculating

- Verify all questions are graded
- Check grade boundaries are configured
- Ensure student isn't marked absent

## Performance Tips

1. **Caching** - Grade boundaries are cached for 30 minutes
2. **Batch Operations** - Use bulk grade for large classes
3. **Indexing** - All foreign keys have indexes
4. **Pagination** - Results are paginated for large datasets
5. **Background Jobs** - Batch PDF runs in background
