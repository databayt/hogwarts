---
title: "Flow Diagrams"
description: "User journey flows with ASCII diagrams and URL references"
---

## Index

1. [Platform Link Flow](#1-platform-link-flow) - School header → Dashboard
2. [Get Started Flow](#2-get-started-flow) - SaaS hero → Onboarding
3. [Live Demo Flow](#3-live-demo-flow) - Marketing → Demo school
4. [Login Flow](#4-login-flow) - Authentication with role redirects
5. [Logout Flow](#5-logout-flow) - Context-aware logout
6. [DEVELOPER Dashboard Flow](#6-developer-dashboard-flow) - SaaS dashboard access

---

## Credentials

All passwords: `1234`

| Role       | Email                   | School   |
| ---------- | ----------------------- | -------- |
| DEVELOPER  | dev@databayt.org        | Platform |
| ADMIN      | admin@databayt.org      | Demo     |
| TEACHER    | teacher@databayt.org    | Demo     |
| STUDENT    | student@databayt.org    | Demo     |
| GUARDIAN   | parent@databayt.org     | Demo     |
| ACCOUNTANT | accountant@databayt.org | Demo     |
| STAFF      | staff@databayt.org      | Demo     |
| USER       | user@databayt.org       | None     |

---

## URLs

| Name               | Localhost                        | Production                     |
| ------------------ | -------------------------------- | ------------------------------ |
| SaaS Marketing     | localhost:3000/en                | ed.databayt.org/en             |
| SaaS Dashboard     | localhost:3000/en/dashboard      | ed.databayt.org/en/dashboard   |
| Operator Dashboard | localhost:3000/en/o              | ed.databayt.org/en/o           |
| Login              | localhost:3000/en/login          | ed.databayt.org/en/login       |
| Onboarding         | localhost:3000/en/onboarding     | ed.databayt.org/en/onboarding  |
| Demo School        | demo.localhost:3000/en           | demo.databayt.org/en           |
| Demo Dashboard     | demo.localhost:3000/en/dashboard | demo.databayt.org/en/dashboard |

---

## 1. Platform Link Flow

User clicks "Platform" from school marketing header.

```
┌─────────────────────────┐
│  School Marketing Site  │
│  (demo.databayt.org)    │
└───────────┬─────────────┘
            │ Click "Platform"
            ▼
       ┌─────────┐
      ╱ Logged   ╲
     ╱   In?      ╲
     ╲            ╱
      ╲          ╱
       └────┬───┘
       NO   │   YES
    ┌───────┴───────┐
    ▼               ▼
┌────────┐    ┌───────────┐
│ Login  │    │  Check    │
│ Page   │    │ Membership│
└───┬────┘    └─────┬─────┘
    │               │
    │         ┌─────┴─────┐
    │         │           │
    ▼         ▼           ▼
┌────────┐ ┌────────┐ ┌──────────┐
│  Auth  │ │Member? │ │DEVELOPER?│
│ Success│ │  YES   │ │   YES    │
└───┬────┘ └───┬────┘ └────┬─────┘
    │          │           │
    ▼          ▼           ▼
┌────────┐ ┌────────┐ ┌────────┐
│ Check  │ │ Role   │ │ Always │
│Membershp│ │ Dash  │ │ Access │
└────────┘ └────────┘ └────────┘

    NO Membership → /access-denied
```

| Step | Action           | Credentials        | Localhost              | Production           |
| ---- | ---------------- | ------------------ | ---------------------- | -------------------- |
| 1    | Click Platform   | -                  | demo.localhost:3000/en | demo.databayt.org/en |
| 2    | Login (if guest) | admin@databayt.org | .../en/login           | .../en/login         |
| 3    | Membership check | ADMIN role         | -                      | -                    |
| 4    | Dashboard        | -                  | .../en/dashboard       | .../en/dashboard     |
| 4b   | Access Denied    | Non-member         | .../en/access-denied   | .../en/access-denied |

---

## 2. Get Started Flow

User clicks "Get Started" from SaaS marketing hero to create a new school.

**Critical**: This is the ONLY path to /onboarding.

**Security**: `/onboarding` is a protected route. Unauthenticated users are redirected to `/login?callbackUrl=/onboarding`.

```
┌─────────────────────────┐
│   SaaS Marketing Site   │
│   (ed.databayt.org)     │
└───────────┬─────────────┘
            │ Click "Get Started"
            ▼
       ┌─────────┐
      ╱ Logged   ╲
     ╱   In?      ╲
     ╲            ╱
      ╲          ╱
       └────┬───┘
       NO   │   YES
    ┌───────┴───────┐
    ▼               ▼
┌────────┐    ┌───────────┐
│ Login  │    │ Onboarding│
│ Page   │    │  Wizard   │
└───┬────┘    └───────────┘
    │
    ▼
┌────────┐
│  Auth  │
│ Success│
└───┬────┘
    │
    ▼
┌───────────┐
│ Onboarding│
│  Wizard   │
└─────┬─────┘
      │
      ▼
┌───────────────┐
│ Create School │
│ Assign ADMIN  │
└───────┬───────┘
        │
        ▼
┌───────────────────┐
│ New School Dash   │
│ (newschool.domain)│
└───────────────────┘
```

| Step | Action            | Credentials       | Localhost                            | Production                         |
| ---- | ----------------- | ----------------- | ------------------------------------ | ---------------------------------- |
| 1    | Click Get Started | -                 | localhost:3000/en                    | ed.databayt.org/en                 |
| 2    | Login (if guest)  | user@databayt.org | .../en/login                         | .../en/login                       |
| 3    | Onboarding wizard | -                 | .../en/onboarding                    | .../en/onboarding                  |
| 4    | Create school     | USER → ADMIN      | -                                    | -                                  |
| 5    | New dashboard     | -                 | {school}.localhost:3000/en/dashboard | {school}.databayt.org/en/dashboard |

---

## 3. Live Demo Flow

User clicks "Live Demo" to explore the demo school without authentication.

```
┌─────────────────────────┐
│  Marketing Site (any)   │
└───────────┬─────────────┘
            │ Click "Live Demo"
            ▼
┌─────────────────────────┐
│   Opens New Tab         │
└───────────┬─────────────┘
            │
            ▼
┌─────────────────────────┐
│   Demo School Site      │
│   (demo.databayt.org)   │
└───────────┬─────────────┘
            │ Click "Platform"
            ▼
       ┌─────────┐
      ╱ Logged   ╲
     ╱   In?      ╲
     ╲            ╱
      ╲          ╱
       └────┬───┘
            │ NO
            ▼
┌─────────────────────────┐
│   Login Page            │
│   (demo credentials)    │
└───────────┬─────────────┘
            │ Use admin@databayt.org
            ▼
┌─────────────────────────┐
│   Demo Dashboard        │
│   (explore features)    │
└─────────────────────────┘
```

| Step | Action          | Credentials        | Localhost              | Production           |
| ---- | --------------- | ------------------ | ---------------------- | -------------------- |
| 1    | Click Live Demo | -                  | Any marketing page     | Any marketing page   |
| 2    | New tab opens   | -                  | demo.localhost:3000/en | demo.databayt.org/en |
| 3    | Click Platform  | -                  | -                      | -                    |
| 4    | Login           | admin@databayt.org | .../en/login           | .../en/login         |
| 5    | Demo Dashboard  | ADMIN role         | .../en/dashboard       | .../en/dashboard     |

---

## 4. Login Flow

Complete authentication flow with role-based redirects.

```
┌─────────────────────────┐
│     Login Page          │
│  /login?context=X       │
└───────────┬─────────────┘
            │ Submit credentials
            ▼
       ┌─────────┐
      ╱ Valid    ╲
     ╱  Creds?    ╲
     ╲            ╱
      ╲          ╱
       └────┬───┘
       NO   │   YES
    ┌───────┴───────┐
    ▼               ▼
┌────────┐    ┌───────────┐
│ Error  │    │  Check    │
│ Message│    │  Context  │
└────────┘    └─────┬─────┘
                    │
        ┌───────────┼───────────┐
        ▼           ▼           ▼
   ┌─────────┐ ┌─────────┐ ┌─────────┐
   │context= │ │context= │ │callback │
   │  saas   │ │ school  │ │   URL   │
   └────┬────┘ └────┬────┘ └────┬────┘
        │           │           │
        ▼           ▼           ▼
   ┌─────────┐ ┌─────────┐ ┌─────────┐
   │DEVELOPER│ │  Stay   │ │Redirect │
   │→ /dash  │ │  on     │ │   to    │
   │ Others  │ │ school  │ │callback │
   │→ stay   │ │marketing│ │   URL   │
   └─────────┘ └─────────┘ └─────────┘
```

| Context     | Role      | Redirect                 |
| ----------- | --------- | ------------------------ |
| saas        | DEVELOPER | /en/dashboard            |
| saas        | USER      | Stay on /en (marketing)  |
| saas        | Other     | Stay on /en (marketing)  |
| school      | Any       | Stay on school marketing |
| callbackUrl | Any       | Redirect to callback URL |

| Step | Action            | Credentials           | Localhost               | Production               |
| ---- | ----------------- | --------------------- | ----------------------- | ------------------------ |
| 1    | Navigate to login | -                     | localhost:3000/en/login | ed.databayt.org/en/login |
| 2    | Enter credentials | See credentials table | -                       | -                        |
| 3a   | DEVELOPER on SaaS | dev@databayt.org      | .../en/dashboard        | .../en/dashboard         |
| 3b   | USER on SaaS      | user@databayt.org     | Stay on .../en          | Stay on .../en           |
| 3c   | Any on school     | Any school member     | Stay on school          | Stay on school           |

---

## 5. Logout Flow

Context-aware logout with appropriate redirects.

```
┌─────────────────────────┐
│  Click Logout (Avatar)  │
└───────────┬─────────────┘
            │
            ▼
       ┌──────────┐
      ╱  Current   ╲
     ╱   Location   ╲
     ╲              ╱
      ╲            ╱
       └─────┬────┘
             │
    ┌────────┼────────┐
    ▼        ▼        ▼
┌───────┐┌───────┐┌────────┐
│ SaaS  ││School ││Operator│
│ Site  ││ Site  ││ Dash   │
└───┬───┘└───┬───┘└───┬────┘
    │        │        │
    ▼        ▼        ▼
┌───────┐┌───────┐┌───────┐
│  /en  ││/{sub} ││  /en  │
│(home) ││(school││(home) │
│       ││ home) ││       │
└───────┘└───────┘└───────┘
```

| Location           | Redirect After Logout                  |
| ------------------ | -------------------------------------- |
| SaaS Marketing     | /{locale} (homepage)                   |
| Operator Dashboard | /{locale} (homepage)                   |
| School Marketing   | /{locale}/s/{subdomain}/ (school home) |
| School Dashboard   | /{locale}/s/{subdomain}/ (school home) |
| Session Expiry     | /login?callbackUrl={current}           |

---

## 6. DEVELOPER Dashboard Flow

DEVELOPER-only SaaS dashboard access at ed.databayt.org/en/dashboard.

### Two Access Paths

```
┌─────────────────────────────────────────────────────────────┐
│                   PATH 1: Via Login Icon                     │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ed.databayt.org/en                                         │
│         │                                                   │
│         │ Click Login icon                                  │
│         ▼                                                   │
│  /login?context=saas                                        │
│         │                                                   │
│         │ Enter credentials                                 │
│         ▼                                                   │
│    ┌─────────┐                                              │
│   ╱ Role?    ╲                                              │
│  ╱           ╲                                              │
│  ╲           ╱                                              │
│   ╲         ╱                                               │
│    └────┬───┘                                               │
│    DEV  │  OTHER                                            │
│  ┌──────┴──────┐                                            │
│  ▼             ▼                                            │
│ /dashboard    Stay on /en                                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────┐
│                   PATH 2: Direct URL                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ed.databayt.org/en/dashboard (direct)                      │
│         │                                                   │
│         │ Protected route                                   │
│         ▼                                                   │
│  /login?callbackUrl=/en/dashboard                           │
│         │                                                   │
│         │ Enter credentials                                 │
│         ▼                                                   │
│    ┌─────────┐                                              │
│   ╱ Role?    ╲                                              │
│  ╱           ╲                                              │
│  ╲           ╱                                              │
│   ╲         ╱                                               │
│    └────┬───┘                                               │
│    DEV  │  OTHER                                            │
│  ┌──────┴──────┐                                            │
│  ▼             ▼                                            │
│ /dashboard    /access-denied                                │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Security Layers

```
Request to /dashboard
        │
        ▼
┌───────────────────────────┐
│  Layer 1: Proxy Middleware │
│  - Extract role from JWT   │
│  - If !DEVELOPER → block   │
└───────────┬───────────────┘
            │ DEVELOPER passes
            ▼
┌───────────────────────────┐
│  Layer 2: Layout Server    │
│  - Full auth() check       │
│  - If !DEVELOPER → redirect│
└───────────┬───────────────┘
            │ DEVELOPER passes
            ▼
    Dashboard Renders ✓
```

### DEVELOPER vs USER Comparison

| Scenario              | DEVELOPER (dev@databayt.org) | USER (user@databayt.org) |
| --------------------- | ---------------------------- | ------------------------ |
| Login from SaaS       | → /dashboard                 | → Stay on /              |
| Direct URL /dashboard | → /dashboard                 | → /access-denied         |
| Login from school     | → Stay on school             | → Stay on school         |

| Step | Action              | Credentials      | Localhost                   | Production                   |
| ---- | ------------------- | ---------------- | --------------------------- | ---------------------------- |
| 1a   | Login from SaaS     | dev@databayt.org | localhost:3000/en           | ed.databayt.org/en           |
| 1b   | Direct to dashboard | dev@databayt.org | localhost:3000/en/dashboard | ed.databayt.org/en/dashboard |
| 2    | Auth check          | DEVELOPER role   | -                           | -                            |
| 3    | SaaS Dashboard      | -                | .../en/dashboard            | .../en/dashboard             |

---

## Related Documentation

- [Authentication](/docs/authentication) - Login/logout implementation
- [Entry Points](/docs/entry-points) - Entry point architecture
- [Multi-Tenancy](/docs/multi-tenancy) - Tenant isolation
- [Onboarding](/docs/onboarding) - School creation wizard
