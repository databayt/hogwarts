import { getAllPrompts } from "@/lib/prompt-parser";
import { PromptTable } from "@/components/docs/prompt-table";
import { PromptSection } from "@/components/docs/prompt-card";

export const metadata = {
  title: "Claude Code Prompts",
  description: "Master collection of specialized prompts for working with Claude Code in the Hogwarts codebase",
};

export default function PromptDocsPage() {
  const { prompts, promptsByCategory, categories } = getAllPrompts();

  return (
    <div className="space-y-8">
      <div>
        <h1>Claude Code Prompts</h1>
        <p className="lead mt-4">
          Master collection of specialized prompts for working with Claude Code in the Hogwarts codebase. These prompts are dynamically loaded from your <code>.claude/</code> directory.
        </p>
      </div>

      <hr />

      {/* Overview */}
      <section>
        <h2>Overview</h2>
        <p>
          This documentation provides a comprehensive library of prompts from your Claude Code automation system. The prompts are automatically extracted from:
        </p>
        <ul>
          <li><strong>Agents</strong> - 20 specialized agents in <code>.claude/agents/</code></li>
          <li><strong>Commands</strong> - 12 workflow shortcuts in <code>.claude/commands/</code></li>
        </ul>
        <p>
          Each prompt includes usage examples, variable placeholders, and tags to help you quickly find and use the right prompt for your task.
        </p>
      </section>

      {/* Stats */}
      <div className="grid gap-4 sm:grid-cols-3">
        <div className="rounded-lg border p-4">
          <h3>{prompts.length}</h3>
          <p className="muted">Total Prompts</p>
        </div>
        <div className="rounded-lg border p-4">
          <h3>{categories.length}</h3>
          <p className="muted">Categories</p>
        </div>
        <div className="rounded-lg border p-4">
          <h3>{prompts.filter(p => p.source === 'agent').length}</h3>
          <p className="muted">Agents</p>
        </div>
      </div>

      <hr />

      {/* Quick Reference */}
      <section>
        <h2>Quick Reference</h2>
        <p className="muted mb-4">
          Browse all available prompts at a glance. Click on a prompt name to jump to its detailed documentation.
        </p>
        <PromptTable prompts={prompts} />
      </section>

      <hr />

      {/* Best Practices */}
      <section>
        <h2>Best Practices</h2>

        <h3>When to Use Which Prompts</h3>
        <p>
          Choose the right prompt based on your task:
        </p>
        <ul>
          <li><strong>Component prompts</strong> - Use when creating or modifying React components</li>
          <li><strong>Database prompts</strong> - Use when working with Prisma models or migrations</li>
          <li><strong>Testing prompts</strong> - Use when writing or debugging tests</li>
          <li><strong>API prompts</strong> - Use when creating server actions or API routes</li>
          <li><strong>Security prompts</strong> - Use when implementing auth or multi-tenant features</li>
          <li><strong>i18n prompts</strong> - Use when adding translations or RTL support</li>
        </ul>

        <h3>How to Combine Prompts</h3>
        <p>
          For complex features, combine multiple prompts:
        </p>
        <ol>
          <li><strong>Start with architecture</strong> - Use <code>/agents/orchestrate</code> for multi-step tasks</li>
          <li><strong>Generate structure</strong> - Use <code>/component</code> or <code>/page</code> commands</li>
          <li><strong>Add backend</strong> - Use <code>/api</code> for server actions</li>
          <li><strong>Ensure quality</strong> - Use <code>/test</code> and <code>/review</code></li>
          <li><strong>Security check</strong> - Use <code>/security-scan</code> and <code>/agents/multi-tenant</code></li>
        </ol>

        <h3>Variable Replacement Tips</h3>
        <p>
          Prompts may include variables that you need to replace:
        </p>
        <ul>
          <li><code>&lt;name&gt;</code> - Replace with component/feature name (e.g., <code>StudentCard</code>)</li>
          <li><code>[path]</code> - Replace with file path (e.g., <code>src/components/student</code>)</li>
          <li><code>$1</code>, <code>$2</code> - Command arguments (replaced automatically)</li>
          <li><code>&#123;component&#125;</code> - Replace with specific component reference</li>
        </ul>

        <h3>Multi-Tenant Safety</h3>
        <p>
          Always verify multi-tenant safety when working with database operations:
        </p>
        <ul>
          <li>Use <code>/agents/multi-tenant</code> to verify <code>schoolId</code> scoping</li>
          <li>Ensure all queries include <code>where: &#123; schoolId &#125;</code></li>
          <li>Test with multiple tenant scenarios</li>
        </ul>
      </section>

      <hr />

      {/* Prompts by Category */}
      <section>
        <h2>Prompts by Category</h2>
        <p className="muted mb-8">
          Detailed documentation for each prompt, organized by category. Each prompt includes usage examples, variables, and tags.
        </p>

        <div className="space-y-12">
          {categories.map((category) => (
            <PromptSection
              key={category}
              category={category}
              prompts={promptsByCategory[category]}
            />
          ))}
        </div>
      </section>

      <hr />

      {/* Additional Resources */}
      <section>
        <h2>Additional Resources</h2>
        <ul>
          <li><a href="/docs/claude-code-introduction">Claude Code Introduction</a></li>
          <li><a href="/docs/claude-code-agents">Agent Documentation</a></li>
          <li><a href="/docs/claude-code-commands">Command Reference</a></li>
          <li><a href="/docs/claude-code-best-practices">Best Practices</a></li>
        </ul>
      </section>
    </div>
  );
}
