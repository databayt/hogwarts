# Claude Code Skills

Extend your agents with modular, reusable capabilities through the Skills system - a powerful way to add specialized functionality to subagents.

## What Are Agent Skills?

Skills are modular capabilities that can be added to subagents, providing:

- **Reusable functionality** across multiple agents
- **Structured tool usage** for specific tasks
- **Domain expertise** (SQL, API testing, etc.)
- **Shareable components** via plugins
- **Focused capabilities** that agents can learn

Unlike subagents (complete AI assistants), skills are **components** that enhance agents with specific abilities.

**Think of it this way**:
- **Subagent** = Complete specialist (e.g., Code Reviewer)
- **Skill** = Specific ability (e.g., SQL Query Optimization)

## Skill Directory Structure

Skills live in `.claude/skills/` directory:

```
your-project/
  .claude/
    skills/
      sql-optimizer/
        SKILL.md          # Skill definition (required)
        examples/         # Example queries
          good.sql
          bad.sql
        patterns.md       # Optimization patterns
      api-tester/
        SKILL.md
        test-cases/
          auth-tests.yaml
          crud-tests.yaml
      performance-analyzer/
        SKILL.md
        benchmarks/
          reference.json
```

## Creating a Skill

### Basic Skill Structure

Create `.claude/skills/sql-optimizer/SKILL.md`:

```markdown
---
name: SQL Optimizer
description: Optimize SQL queries for performance
version: 1.0.0
category: database
tags: [sql, performance, optimization]
---

# SQL Query Optimization Skill

## Capabilities

This skill enables agents to:
- Analyze SQL query performance
- Identify N+1 query problems
- Suggest index improvements
- Optimize complex joins
- Detect inefficient patterns

## Knowledge Base

### Common Anti-Patterns

1. **N+1 Queries**
```sql
-- Bad: Multiple queries
SELECT * FROM users;
-- Then for each user:
SELECT * FROM posts WHERE user_id = ?;

-- Good: Single query with join
SELECT users.*, posts.*
FROM users
LEFT JOIN posts ON posts.user_id = users.id;
```

2. **Missing Indexes**
```sql
-- Add index for frequently queried columns
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_posts_user_id ON posts(user_id);
```

3. **SELECT ***
```sql
-- Bad: Fetches all columns
SELECT * FROM users WHERE id = 1;

-- Good: Fetch only needed columns
SELECT id, name, email FROM users WHERE id = 1;
```

### Optimization Checklist

- [ ] Remove SELECT *
- [ ] Add appropriate indexes
- [ ] Eliminate N+1 queries
- [ ] Use EXPLAIN to analyze query plan
- [ ] Consider query caching
- [ ] Batch operations where possible
- [ ] Use prepared statements

## Usage Pattern

When analyzing a query:
1. Read the query
2. Check for anti-patterns
3. Analyze with EXPLAIN
4. Suggest specific optimizations
5. Provide optimized version
6. Explain performance impact

## Reference Files

See example files in this skill directory:
- @examples/good.sql - Optimized queries
- @examples/bad.sql - Anti-patterns to avoid
- @patterns.md - Detailed optimization patterns
```

### Skill Configuration (YAML Frontmatter)

```yaml
---
name: Skill Display Name
description: Brief description of the skill
version: 1.0.0
category: database|testing|security|performance|documentation
tags: [tag1, tag2, tag3]
author: Your Name
license: MIT
dependencies: []
minClaudeVersion: 1.0.0
---
```

**Configuration Fields**:

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `name` | string | Yes | Skill display name |
| `description` | string | Yes | Brief description (shown in lists) |
| `version` | string | Yes | Semantic version (1.0.0) |
| `category` | string | No | Category for organization |
| `tags` | array | No | Searchable tags |
| `author` | string | No | Creator name |
| `license` | string | No | License type |
| `dependencies` | array | No | Required skills |
| `minClaudeVersion` | string | No | Minimum Claude Code version |

## Adding Skills to Agents

Skills are added to agents via their frontmatter:

`.claude/agents/database-expert.md`:

```markdown
---
name: Database Expert
description: Database optimization specialist
model: claude-3-5-sonnet-20250514
skills:
  - sql-optimizer
  - query-analyzer
allowedTools:
  - Read
  - Grep
  - Bash(psql:*)
---

You are a database expert with specialized skills in SQL optimization.

When analyzing queries, use your SQL Optimizer skill to:
1. Identify performance issues
2. Suggest optimizations
3. Provide before/after comparisons

Reference @.claude/skills/sql-optimizer/examples/ for patterns.
```

## Real-World Skill Examples

### API Testing Skill

`.claude/skills/api-tester/SKILL.md`:

```markdown
---
name: API Tester
description: Comprehensive API testing methodology
version: 1.0.0
category: testing
tags: [api, testing, rest, graphql]
---

# API Testing Skill

## Test Categories

### 1. Authentication Tests
- Valid credentials
- Invalid credentials
- Expired tokens
- Missing auth headers
- Token refresh flow

### 2. CRUD Operation Tests
- Create resource (201 Created)
- Read resource (200 OK)
- Update resource (200 OK)
- Delete resource (204 No Content)
- Resource not found (404)

### 3. Validation Tests
- Missing required fields (400 Bad Request)
- Invalid field types (400 Bad Request)
- Field length violations (400 Bad Request)
- Invalid enum values (400 Bad Request)

### 4. Authorization Tests
- Access without permission (403 Forbidden)
- Access other user's resources (403)
- Admin-only endpoints (403 for non-admin)

### 5. Error Handling Tests
- Server errors (500)
- Rate limiting (429)
- Timeout handling
- Malformed JSON (400)

## Test Template

```javascript
describe('POST /api/users', () => {
  it('creates user with valid data', async () => {
    const response = await fetch('/api/users', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        name: 'John Doe',
        email: 'john@example.com'
      })
    });

    expect(response.status).toBe(201);
    expect(response.data).toMatchObject({
      name: 'John Doe',
      email: 'john@example.com'
    });
  });

  it('returns 400 for missing required fields', async () => {
    const response = await fetch('/api/users', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name: 'John Doe' }) // Missing email
    });

    expect(response.status).toBe(400);
    expect(response.error).toContain('email is required');
  });
});
```

## Reference Files

- @test-cases/auth-tests.yaml - Authentication test cases
- @test-cases/crud-tests.yaml - CRUD operation tests
```

### Security Audit Skill

`.claude/skills/security-auditor/SKILL.md`:

```markdown
---
name: Security Auditor
description: Security vulnerability detection patterns
version: 1.0.0
category: security
tags: [security, vulnerability, owasp]
---

# Security Audit Skill

## OWASP Top 10 Checks

### A01:2021 - Broken Access Control
- Check for missing authorization checks
- Verify role-based access control (RBAC)
- Look for insecure direct object references
- Check for path traversal vulnerabilities

### A02:2021 - Cryptographic Failures
- Ensure sensitive data is encrypted at rest
- Verify TLS/SSL for data in transit
- Check for weak cryptographic algorithms
- Look for hardcoded secrets

### A03:2021 - Injection
- SQL injection prevention (parameterized queries)
- Command injection checks
- LDAP injection
- NoSQL injection

### A04:2021 - Insecure Design
- Check for security controls at design level
- Verify threat modeling
- Check for secure defaults

### A05:2021 - Security Misconfiguration
- Verify security headers (CSP, HSTS, etc.)
- Check for unnecessary features enabled
- Look for default credentials
- Check error handling (no stack traces in production)

### A06:2021 - Vulnerable Components
- Check for outdated dependencies
- Run npm audit / yarn audit
- Verify no known CVEs

### A07:2021 - Identification and Authentication Failures
- Password policy enforcement
- Multi-factor authentication support
- Session management security
- Credential stuffing protection

### A08:2021 - Software and Data Integrity Failures
- Verify integrity of dependencies
- Check for unsigned updates
- CI/CD pipeline security

### A09:2021 - Security Logging and Monitoring Failures
- Verify comprehensive logging
- Check for sensitive data in logs
- Ensure audit trails exist

### A10:2021 - Server-Side Request Forgery (SSRF)
- Validate and sanitize user-supplied URLs
- Check for internal service access
- Verify URL allowlisting

## Code Patterns to Flag

### Dangerous Functions
```javascript
// ❌ Dangerous
eval(userInput);
new Function(userInput);
exec(userInput);

// ✅ Safe alternatives
// Use JSON.parse() instead of eval
// Use proper templating instead of Function constructor
// Use execFile with argument array instead of exec
```

### SQL Injection
```javascript
// ❌ Vulnerable
db.query(`SELECT * FROM users WHERE id = ${userId}`);

// ✅ Safe
db.query('SELECT * FROM users WHERE id = ?', [userId]);
```

### XSS Prevention
```javascript
// ❌ Vulnerable
element.innerHTML = userInput;

// ✅ Safe
element.textContent = userInput;
// Or use DOMPurify
element.innerHTML = DOMPurify.sanitize(userInput);
```

## Audit Process

1. **Reconnaissance**: Identify attack surface
2. **Static Analysis**: Review code for vulnerabilities
3. **Dynamic Analysis**: Test runtime behavior
4. **Report**: Document findings with severity
5. **Remediation**: Provide fixes
```

### Performance Analyzer Skill

`.claude/skills/performance-analyzer/SKILL.md`:

```markdown
---
name: Performance Analyzer
description: Analyze and optimize code performance
version: 1.0.0
category: performance
tags: [performance, optimization, profiling]
---

# Performance Analysis Skill

## Analysis Areas

### 1. Runtime Performance
- Time complexity analysis
- Space complexity analysis
- Algorithmic efficiency
- Loop optimization

### 2. Memory Usage
- Memory leaks
- Unnecessary allocations
- Object pooling opportunities
- Garbage collection impact

### 3. Network Performance
- API call batching
- Caching strategies
- Lazy loading
- Prefetching

### 4. Rendering Performance (Frontend)
- Re-render optimization
- Virtual scrolling for lists
- Code splitting
- Bundle size optimization

## Optimization Patterns

### Memoization
```javascript
// ❌ Expensive recalculation
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}

// ✅ Memoized
const fibonacci = (() => {
  const cache = {};
  return function fib(n) {
    if (n in cache) return cache[n];
    if (n <= 1) return n;
    cache[n] = fib(n - 1) + fib(n - 2);
    return cache[n];
  };
})();
```

### Debouncing
```javascript
// ❌ Calls on every keystroke
input.addEventListener('input', (e) => {
  searchAPI(e.target.value);
});

// ✅ Debounced
const debounce = (fn, delay) => {
  let timer;
  return (...args) => {
    clearTimeout(timer);
    timer = setTimeout(() => fn(...args), delay);
  };
};

input.addEventListener('input', debounce((e) => {
  searchAPI(e.target.value);
}, 300));
```

### Lazy Loading
```javascript
// ❌ Load everything upfront
import { HugeComponent } from './HugeComponent';

// ✅ Lazy load
const HugeComponent = lazy(() => import('./HugeComponent'));
```

## Benchmarking Process

1. **Establish baseline**: Measure current performance
2. **Identify bottlenecks**: Profile to find slow areas
3. **Optimize**: Apply targeted improvements
4. **Measure again**: Verify improvements
5. **Iterate**: Repeat for remaining bottlenecks

## Tools

- **Chrome DevTools**: Performance profiling
- **Lighthouse**: Web vitals analysis
- **Bundle analyzers**: Webpack/Vite bundle analysis
- **Memory profilers**: Heap snapshots
- **Load testing**: Artillery, k6, JMeter
```

## Supporting Files in Skills

Skills can include supporting files for reference:

```
.claude/skills/sql-optimizer/
  SKILL.md                    # Main skill definition
  examples/
    good.sql                  # Best practices
    bad.sql                   # Anti-patterns
  patterns.md                 # Detailed patterns
  benchmarks/
    results.json              # Performance data
  tools/
    explain-analyzer.sh       # Helper scripts
```

Reference these in SKILL.md:

```markdown
## Reference Materials

Study these examples:
- @examples/good.sql - Optimized query patterns
- @examples/bad.sql - Anti-patterns to avoid
- @patterns.md - Detailed optimization strategies
- @benchmarks/results.json - Performance comparisons

Use helper tools:
- @tools/explain-analyzer.sh - Analyze EXPLAIN output
```

## Skill Best Practices

### Focus on Specific Domain

❌ **Too Broad**:
```markdown
---
name: Full Stack Developer
description: Can do everything
---
```

✅ **Focused**:
```markdown
---
name: React Performance Optimizer
description: Optimize React component rendering
---
```

### Provide Concrete Examples

Always include code examples:

```markdown
## Pattern: Avoid Inline Functions

❌ **Bad**:
```jsx
<button onClick={() => handleClick(id)}>
```

✅ **Good**:
```jsx
const onClick = useCallback(() => handleClick(id), [id]);
<button onClick={onClick}>
```

### Include Checklists

Make skills actionable:

```markdown
## Optimization Checklist

- [ ] Profile before optimizing
- [ ] Focus on biggest bottlenecks
- [ ] Measure impact after changes
- [ ] Document performance improvements
- [ ] Add performance regression tests
```

### Version Your Skills

Update version when changing:

```yaml
---
name: SQL Optimizer
version: 1.1.0  # Incremented from 1.0.0
---

## Changelog

### 1.1.0
- Added PostgreSQL-specific optimizations
- Included index usage analysis
- Added query plan visualization
```

## Sharing Skills via Plugins

Package skills for distribution:

```
my-skills-plugin/
  package.json
  README.md
  .claude/
    skills/
      sql-optimizer/
      api-tester/
      security-auditor/
```

Install via plugin system:

```bash
claude /plugin install my-skills-plugin
```

## Tool Restrictions in Skills

Skills themselves don't execute - agents with skills do. The agent's `allowedTools` determines what's possible.

**Skill Definition** (no tool restrictions):
```markdown
---
name: Git Helper
description: Git workflow assistance
---

Use git commands to:
- Check status
- Create branches
- Review diffs
```

**Agent Using Skill** (with tool restrictions):
```markdown
---
name: Git Assistant
skills: [git-helper]
allowedTools:
  - Read
  - Bash(git:*)
---
```

## Discovering Skills

### List Installed Skills

```bash
claude /skills list
```

### Search Skills

```bash
claude /skills search performance
```

### Skill Information

```bash
claude /skills info sql-optimizer
```

## Advanced Patterns

### Skill Dependencies

Skills can depend on other skills:

```yaml
---
name: Full Stack Optimizer
description: Optimize full stack applications
dependencies:
  - sql-optimizer
  - react-optimizer
  - api-optimizer
---
```

Claude loads all dependencies automatically.

### Conditional Skill Loading

Agents can load skills conditionally:

```markdown
---
name: Smart Developer
---

Analyzing project...

!cat package.json

Based on dependencies:
- If React detected: [Load react-optimizer skill]
- If PostgreSQL detected: [Load sql-optimizer skill]
- If Express detected: [Load api-optimizer skill]
```

## Troubleshooting

### Skill Not Found

```
Error: Skill 'sql-optimizer' not found
```

**Fix**: Verify `.claude/skills/sql-optimizer/SKILL.md` exists

### Skill Not Loading

Check YAML frontmatter:

```bash
cat .claude/skills/your-skill/SKILL.md | head -n 20
```

### Skill Version Conflicts

```
Error: Agent requires sql-optimizer v2.0.0 but v1.0.0 is installed
```

**Fix**: Update skill or adjust agent requirements

## Next Steps

- [Subagents](/docs/claude-code-subagents) - Create agents that use skills
- [Plugins](/docs/claude-code-plugins) - Share skills via plugins
- [Best Practices](/docs/claude-code-best-practices) - Effective skill usage
- [Slash Commands](/docs/claude-code-slash-commands) - Automate skill invocation

## Resources

- **Skill Library**: Browse community skills
- **Skill Templates**: Starter templates for new skills
- **Best Practices**: Patterns for effective skills

---

*Skills make agents more capable by giving them specialized knowledge. Build a library of skills your team can leverage across all agents.*
