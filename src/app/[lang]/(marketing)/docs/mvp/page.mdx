export const metadata = {
  title: 'MVP - Hogwarts',
  description: 'MVP implementation checklist for Hogwarts School Automation Platform',
}

# MVP

## Epics

- Epic 1: Foundation & Infrastructure [15 stories]
- Epic 2: Authentication & Authorization [18 stories]
- Epic 3: School Configuration [12 stories]
- Epic 4: Student Management [20 stories]
- Epic 5: Teacher & Staff Management [15 stories]
- Epic 6: Class & Subject Management [18 stories]

**Total: 98 stories**

---

## Epic 1: Foundation & Infrastructure

**Goal:** Multi-tenant architecture, subdomain routing, core setup

- [ ] Multi-tenant database schema with `schoolId` scoping
  - **Acceptance Criteria:** All business models include required `schoolId` field with `@@index([schoolId])`, unique constraints scoped by `schoolId`

- [ ] Subdomain routing working (`school.databayt.org`)
  - **Acceptance Criteria:** Middleware rewrites `school.databayt.org` to `/[lang]/s/school/...`, works in production/preview/development

- [ ] Next.js 15 + React 19 + Prisma 6 configured
  - **Acceptance Criteria:** `package.json` shows correct versions, app builds and runs without errors, Turbopack enabled

- [ ] CI/CD pipeline with automated tests
  - **Acceptance Criteria:** GitHub Actions runs tests on PR, auto-deploys to Vercel on merge to main, pipeline completes in less than 5 minutes

- [ ] Error monitoring (Sentry) operational
  - **Acceptance Criteria:** Sentry captures errors with source maps, error boundaries catch UI errors, alerts configured

- [ ] Internationalization (Arabic/English) functional
  - **Acceptance Criteria:** Language switcher changes locale, 800+ translation keys work, RTL/LTR layouts render correctly

- [ ] Development/staging/production environments
  - **Acceptance Criteria:** Three environments configured in Vercel, environment variables set per environment, database per environment

- [ ] Database singleton pattern implemented
  - **Acceptance Criteria:** Prisma client uses global caching, dev hot-reload safe, no multiple client instances

- [ ] Testing infrastructure (Vitest, Playwright)
  - **Acceptance Criteria:** `pnpm test` runs Vitest, `pnpm test:e2e` runs Playwright, both configured with proper paths

- [ ] Multi-tenant test suite with isolation verification
  - **Acceptance Criteria:** Tests verify no cross-tenant data leaks, test fixtures for 2+ schools, automated tests pass

- [ ] Middleware for subdomain rewriting
  - **Acceptance Criteria:** `src/middleware.ts` extracts subdomain and rewrites to tenant-scoped routes, handles edge cases

- [ ] Tenant context helper functional
  - **Acceptance Criteria:** `getTenantContext()` returns `{ schoolId, subdomain }`, works in Server Components and Server Actions

- [ ] Environment configuration type-safe
  - **Acceptance Criteria:** Using `@t3-oss/env-nextjs`, all env vars typed, build fails if required vars missing

- [ ] Tailwind CSS 4 with RTL/LTR support
  - **Acceptance Criteria:** shadcn/ui configured, RTL utilities work for Arabic, custom color palette applied

- [ ] Layout structure with font configuration
  - **Acceptance Criteria:** Root layout loads fonts (Tajawal/Inter), locale-aware layout works, platform layout has sidebar

**Key Files:**
- `src/middleware.ts` - Subdomain routing and i18n
- `src/lib/tenant-context.ts` - Tenant context helper
- `src/lib/db.ts` - Prisma client singleton
- `src/env.mjs` - Type-safe environment configuration
- `prisma/schema.prisma` - Database schema
- `prisma/models/*.prisma` - 27 individual model files
- `.github/workflows/*.yml` - CI/CD pipelines
- `vitest.config.ts` - Vitest configuration
- `playwright.config.ts` - Playwright configuration
- `tailwind.config.ts` - Tailwind CSS configuration
- `src/styles/typography.css` - Typography system
- `src/app/[lang]/layout.tsx` - Root layout with fonts

**Documentation:**
- `README.md` - Project overview and setup
- `CLAUDE.md` - Essential development guidelines
- `/docs/architecture` - System architecture
- `/docs/build` - Build system documentation
- `/docs/stack` - Tech stack details

**Claude Code Resources:**
- `.claude/settings.json` - Claude Code configuration
- `.claude/commands/*.md` - 22 custom slash commands
- `.claude/prompts/agents/*.md` - 33 specialized agents
- `.claude/prompts/skills/*.md` - 7 reusable skills

**Inspiration & Best Practices:**
- [Dashboard Examples](/docs/inspiration#dashboard) - shadcn dashboard patterns
- [Table/List Patterns](/docs/inspiration#table-lists) - Data table best practices
- [Form Patterns](/docs/inspiration#forms) - Form design and validation
- [Awesome shadcn](/docs/awesome-shadcn) - Curated component blocks

---

## Epic 2: Authentication & Authorization

**Goal:** User management, 8-role RBAC, secure authentication

- [ ] NextAuth v5 configured with JWT strategy
  - **Acceptance Criteria:** `src/auth.ts` configured, JWT tokens generated, 24-hour session expiry, callbacks extend session

- [ ] Email/password auth with bcrypt hashing
  - **Acceptance Criteria:** Users can register/login with email/password, passwords hashed with bcrypt (cost 12), credentials provider configured

- [ ] OAuth providers (Google, Facebook) working
  - **Acceptance Criteria:** Google OAuth flow completes, Facebook OAuth flow completes, accounts linked to users

- [ ] Two-factor authentication (2FA) functional
  - **Acceptance Criteria:** Users can enable 2FA, TOTP codes verified, backup codes generated, login requires 2FA when enabled

- [ ] DEVELOPER role implemented
  - **Acceptance Criteria:** Platform admin role with no `schoolId`, can access all schools, special permissions granted

- [ ] ADMIN role implemented
  - **Acceptance Criteria:** School admin with full school access, can manage users, configure settings, access all modules

- [ ] TEACHER role implemented
  - **Acceptance Criteria:** Can manage assigned classes, mark attendance, grade assignments, view own schedule

- [ ] STUDENT role implemented
  - **Acceptance Criteria:** Can view own grades/attendance/assignments, submit work, view own profile only

- [ ] GUARDIAN role implemented
  - **Acceptance Criteria:** Can view linked students' data, communicate with teachers, pay fees, receive notifications

- [ ] ACCOUNTANT role implemented
  - **Acceptance Criteria:** Can manage finances, generate reports, no access to academic data, view fee records

- [ ] STAFF role implemented
  - **Acceptance Criteria:** Limited operational access, module-specific permissions, no student data access

- [ ] USER role (default) implemented
  - **Acceptance Criteria:** Minimal access until admin assigns proper role, can view profile, pending role assignment

- [ ] Role-based access control enforced on routes
  - **Acceptance Criteria:** Middleware blocks unauthorized routes, role-based menu renders correctly, API checks permissions

- [ ] Password reset flow complete
  - **Acceptance Criteria:** Reset email sent with token, token expires after 1 hour, new password saved and hashed

- [ ] Session management with auto-renewal
  - **Acceptance Criteria:** Sessions renew before expiry, logout clears session, session includes `schoolId` and role

- [ ] User profile management
  - **Acceptance Criteria:** Users can update name/email/photo, changes persist, profile page displays data

- [ ] User invitation system
  - **Acceptance Criteria:** Admins can invite users via email, invitation links expire, users complete registration

- [ ] Audit logging for sensitive operations
  - **Acceptance Criteria:** All mutations logged with user/timestamp/schoolId, 7-year retention, immutable logs

**Key Files:**
- `src/auth.ts` - NextAuth v5 configuration
- `src/auth.config.ts` - Authentication callbacks
- `src/middleware.ts` - Route protection
- `src/routes.ts` - Route definitions and protection
- `prisma/models/auth.prisma` - User, Account, Session, VerificationToken models
- `src/app/[lang]/(auth)/*` - Authentication pages (login, register, reset)
- `src/components/auth/*` - Auth UI components

**Documentation:**
- `/docs/api-authentication` - API authentication guide
- `.github/ISSUE_TEMPLATE/security.md` - Security issue template

**Inspiration & Best Practices:**
- [Auth UI Patterns](/docs/inspiration#auth) - Login/register design
- [Form Patterns](/docs/inspiration#forms) - Form validation

---

## Epic 3: School Configuration

**Goal:** School setup, academic structure, year levels

- [ ] School profile creation and management
  - **Acceptance Criteria:** School form saves name/address/contact, data persists in database, `schoolId` generated

- [ ] School information display
  - **Acceptance Criteria:** School info renders on settings page, shows all fields, editable by admin

- [ ] Academic year setup with start/end dates
  - **Acceptance Criteria:** Admin can create academic year, start/end dates validated, current year marked active

- [ ] Term/period configuration
  - **Acceptance Criteria:** Admin can define terms (semester/trimester/quarter), dates non-overlapping, linked to academic year

- [ ] Year level/grade configuration
  - **Acceptance Criteria:** Admin can add grades (1-12), custom grade names supported, order configurable

- [ ] Department management
  - **Acceptance Criteria:** CRUD operations for departments, teachers assigned to departments, departments listed

- [ ] School branding (logo upload)
  - **Acceptance Criteria:** Admin can upload logo (PNG/JPG), logo saved to storage, logo displays in header

- [ ] Color picker for school colors
  - **Acceptance Criteria:** Admin can select primary/secondary colors, colors applied to theme, preview works

- [ ] Timezone configuration
  - **Acceptance Criteria:** Admin can select timezone, dates/times formatted per timezone, saved in school settings

- [ ] School settings page functional
  - **Acceptance Criteria:** Settings page accessible to admin, all configuration options available, changes persist

- [ ] School setup wizard for onboarding
  - **Acceptance Criteria:** Multi-step wizard guides new schools, collects essential data, redirects to dashboard on completion

- [ ] Logo preview and management
  - **Acceptance Criteria:** Uploaded logo shows preview, admin can replace logo, logo displays throughout app

**Key Files:**
- `src/components/platform/settings/*` - School settings components
- `src/app/[lang]/s/[subdomain]/(platform)/settings/*` - Settings routes
- `prisma/models/school.prisma` - School model
- `prisma/models/branding.prisma` - Branding configuration

**Documentation:**
- `/docs/add-school` - School onboarding guide

**Inspiration & Best Practices:**
- [Onboarding Patterns](/docs/inspiration#onboarding) - Multi-step wizard design
- [Form Patterns](/docs/inspiration#forms) - Settings forms

---

## Epic 4: Student Management

**Goal:** Student lifecycle from enrollment to graduation

- [ ] Student enrollment form working
  - **Acceptance Criteria:** Form validates required fields, saves to database with `schoolId`, redirects to student profile

- [ ] Student profile page structure (7 tabs)
  - **Acceptance Criteria:** Profile has Personal/Academic/Health/Documents/Achievements/Disciplinary/Fees tabs, navigation works

- [ ] Personal information tab complete
  - **Acceptance Criteria:** Displays name/DOB/gender/contact, editable, shows photo, guardian links visible

- [ ] Academic information tab complete
  - **Acceptance Criteria:** Shows current grade/classes/subjects, enrollment history, academic status

- [ ] Health records tab complete
  - **Acceptance Criteria:** Medical conditions listed, allergies tracked, medications recorded, emergency protocols

- [ ] Documents tab with upload capability
  - **Acceptance Criteria:** Upload birth certificate/IDs/records, files stored, download/preview works

- [ ] Achievements tab with tracking
  - **Acceptance Criteria:** Awards/honors listed, date/description recorded, viewable by student/guardian

- [ ] Disciplinary records tab
  - **Acceptance Criteria:** Incidents logged, severity categorized, actions taken recorded, admin only access

- [ ] Fees tab with payment history
  - **Acceptance Criteria:** Outstanding fees shown, payment history listed, receipts downloadable

- [ ] Student search functionality
  - **Acceptance Criteria:** Search by name/ID/email, results filtered by `schoolId`, real-time search works

- [ ] Advanced filtering system
  - **Acceptance Criteria:** Filter by grade/status/class, multiple filters combine, URL-synced state

- [ ] Guardian relationships and linking
  - **Acceptance Criteria:** Multiple guardians per student, relationship type specified, contact info visible

- [ ] Document upload and management
  - **Acceptance Criteria:** Drag-and-drop upload, file type validation, delete/replace documents

- [ ] Photo upload and display
  - **Acceptance Criteria:** Student photo upload works, image cropped/resized, displays in profile/lists

- [ ] Batch operations (bulk actions)
  - **Acceptance Criteria:** Select multiple students, bulk status update, bulk class enrollment, progress shown

- [ ] Student export (individual)
  - **Acceptance Criteria:** Export single student to PDF, includes all tabs, formatted report

- [ ] Student export (bulk CSV)
  - **Acceptance Criteria:** Export filtered students to CSV, all fields included, scoped by `schoolId`

- [ ] Status transitions (enrolled/transferred/graduated)
  - **Acceptance Criteria:** Status changes logged, workflow enforced, historical data retained

- [ ] Previous education records
  - **Acceptance Criteria:** Prior schools recorded, transcripts attached, dates validated

- [ ] Emergency contact management
  - **Acceptance Criteria:** Multiple emergency contacts, priority order, quick access for admin

**Key Files:**
- `src/components/platform/students/*` - Student components
- `src/app/[lang]/s/[subdomain]/(platform)/students/*` - Student routes
- `prisma/models/students.prisma` - Student model
- `prisma/models/admission.prisma` - Admission workflow

**Documentation:**
- `/docs/features-students` - Student management features
- `.github/ISSUE_TEMPLATE/feature_request.md` - Feature request template

**Inspiration & Best Practices:**
- [Table Patterns](/docs/inspiration#table-lists) - Student lists
- [Form Patterns](/docs/inspiration#forms) - Enrollment forms
- [File Upload](/docs/inspiration#file-storage--management) - Document management
- [School Management Examples](/docs/inspiration#school) - Real-world implementations

---

## Epic 5: Teacher & Staff Management

**Goal:** Teacher profiles, qualifications, workload tracking

- [ ] Teacher profile creation form
  - **Acceptance Criteria:** Form captures name/email/qualifications, role set to TEACHER, `schoolId` included

- [ ] Teacher profile display page
  - **Acceptance Criteria:** Shows personal info/qualifications/assignments, editable by admin, viewable by teacher

- [ ] Qualifications management
  - **Acceptance Criteria:** Degrees listed with institution/year, certifications tracked, documents attached

- [ ] Certifications tracking
  - **Acceptance Criteria:** Teaching certificates recorded, expiry dates tracked, renewal reminders

- [ ] Department assignment
  - **Acceptance Criteria:** Teacher assigned to 1+ departments, department shown in profile, filtered lists work

- [ ] Subject expertise tracking
  - **Acceptance Criteria:** Teacher linked to subjects they can teach, expertise level specified, used in assignment

- [ ] Workload calculator
  - **Acceptance Criteria:** Total teaching hours calculated, class count shown, alerts for overload

- [ ] Class assignments
  - **Acceptance Criteria:** Teacher assigned to classes, subject specified, schedule conflicts detected

- [ ] Teacher dashboard
  - **Acceptance Criteria:** Dashboard shows assigned classes/schedule/upcoming tasks, quick actions available

- [ ] Leave request system
  - **Acceptance Criteria:** Teachers submit leave requests, admin approves/rejects, status tracked

- [ ] Substitution management
  - **Acceptance Criteria:** Substitute teachers assigned for absences, notifications sent, schedule updated

- [ ] Contract management
  - **Acceptance Criteria:** Contract start/end dates recorded, renewal tracked, document attached

- [ ] Professional development tracking
  - **Acceptance Criteria:** Training/workshops logged, certificates attached, hours tracked

- [ ] Teacher timetable view
  - **Acceptance Criteria:** Weekly schedule displayed, classes shown with times/rooms, print/export works

- [ ] Non-teaching staff management
  - **Acceptance Criteria:** Staff profiles created, STAFF role assigned, module access configured

**Key Files:**
- `src/components/platform/teachers/*` - Teacher components
- `src/components/platform/staff/*` - Staff components
- `src/app/[lang]/s/[subdomain]/(platform)/teachers/*` - Teacher routes
- `prisma/models/staff.prisma` - Teacher and Staff models

**Inspiration & Best Practices:**
- [Dashboard Examples](/docs/inspiration#dashboard) - Teacher dashboard
- [Table Patterns](/docs/inspiration#table-lists) - Teacher lists

---

## Epic 6: Class & Subject Management

**Goal:** Academic organization, timetable, class scheduling

- [ ] Subject catalog creation
  - **Acceptance Criteria:** Subjects created with code/name/description, scoped by `schoolId`, listed in catalog

- [ ] Subject management (CRUD operations)
  - **Acceptance Criteria:** Create/read/update/delete subjects, validation works, used in class creation

- [ ] Class creation with details
  - **Acceptance Criteria:** Class created with subject/grade/section, capacity set, academic year linked

- [ ] Class capacity management
  - **Acceptance Criteria:** Max students enforced, enrollment blocked when full, waitlist optional

- [ ] Student enrollment in classes
  - **Acceptance Criteria:** Students added to classes, enrollment date recorded, status tracked

- [ ] Student-class conflict detection
  - **Acceptance Criteria:** Alerts if student already in another section, schedule conflicts detected

- [ ] Teacher assignment to classes
  - **Acceptance Criteria:** Teacher assigned as primary instructor, subject match validated, one teacher per class

- [ ] Teacher-subject allocation
  - **Acceptance Criteria:** Teacher expertise matched to subject, workload considered, allocation saved

- [ ] Visual timetable builder
  - **Acceptance Criteria:** Drag-and-drop interface for scheduling, weekly grid view, changes persist

- [ ] Drag-and-drop scheduling
  - **Acceptance Criteria:** Drag classes to time slots, conflicts highlighted, auto-save works

- [ ] Period-wise scheduling
  - **Acceptance Criteria:** Schedule divided into periods, duration configurable, period names customizable

- [ ] Break management in schedule
  - **Acceptance Criteria:** Breaks inserted between periods, lunch break configured, no classes during breaks

- [ ] Room allocation
  - **Acceptance Criteria:** Rooms assigned to classes, room capacity checked, double-booking prevented

- [ ] Conflict detection for scheduling
  - **Acceptance Criteria:** Teacher conflicts detected, room conflicts detected, student conflicts detected

- [ ] Class sections management
  - **Acceptance Criteria:** Multiple sections per subject/grade, section names unique, independent enrollment

- [ ] Class analytics dashboard
  - **Acceptance Criteria:** Enrollment trends shown, attendance stats displayed, performance metrics visible

- [ ] Resource sharing within class
  - **Acceptance Criteria:** Teachers share materials with class, students access resources, upload/download works

- [ ] Class roster export
  - **Acceptance Criteria:** Export class student list to PDF/CSV, includes photos/contact, scoped by class

**Key Files:**
- `src/components/platform/classes/*` - Class components
- `src/components/platform/subjects/*` - Subject components
- `src/components/platform/timetable/*` - Timetable builder
- `src/app/[lang]/s/[subdomain]/(platform)/classes/*` - Class routes
- `src/app/[lang]/s/[subdomain]/(platform)/subjects/*` - Subject routes
- `src/app/[lang]/s/[subdomain]/(platform)/timetable/*` - Timetable routes
- `prisma/models/classrooms.prisma` - Class models
- `prisma/models/subjects.prisma` - Subject models
- `prisma/models/timetable.prisma` - Timetable models
- `prisma/models/schedule.prisma` - Schedule models

**Documentation:**
- `/docs/timetable` - Timetable builder guide

**Inspiration & Best Practices:**
- [Dashboard Examples](/docs/inspiration#dashboard) - Class analytics
- [Table Patterns](/docs/inspiration#table-lists) - Class rosters
- [School Management Examples](/docs/inspiration#school) - Timetable implementations
