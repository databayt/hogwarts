// Expense receipt tracking with AI-powered OCR extraction
model ExpenseReceipt {
  id       String @id @default(cuid())
  schoolId String
  userId   String

  // File information
  fileName        String
  fileDisplayName String?
  fileUrl         String
  fileSize        Int
  mimeType        String

  // Processing status
  status String @default("pending") // pending, processing, processed, error

  // Extracted data (OCR results)
  merchantName      String?
  merchantAddress   String?
  merchantContact   String?
  transactionDate   DateTime?
  transactionAmount Decimal?  @db.Decimal(10, 2)
  currency          String?   @default("USD")
  receiptSummary    String?   @db.Text

  // Line items (stored as JSON)
  items Json? // Array of {name, quantity, unitPrice, totalPrice}

  // Metadata
  uploadedAt  DateTime  @default(now())
  processedAt DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  // Relations
  school School @relation(fields: [schoolId], references: [id], onDelete: Cascade)
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([schoolId])
  @@index([userId])
  @@index([status])
  @@index([transactionDate])
  @@map("expense_receipts")
}
